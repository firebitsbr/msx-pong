Sjasm Z80 Assembler v0.42c - www.xl2s.tk             [2020.03.22 - 03:08:41]

msx-pong.asm
Errors: 0

       1   00:0000                      ;------------------------------------------------------------------------
       2   00:0000                      ; HEADER FOR GENERATING A ROM FILE
       3   00:0000                      ;------------------------------------------------------------------------
       4   00:0000                      ;     output "../output/msxpong.rom"
       5   00:0000                      
       6   00:0000                      ;     defpage 0,4000h,16384
       7   00:0000                      ;     ; defpage 1,8000h
       8   00:0000                      
       9   00:0000                      ;     page 0
      10   00:0000                      
      11   00:0000                      ;     code @ 4000h
      12   00:0000                      
      13   00:0000                      ; romheader
      14   00:0000                      ;     byte "AB"
      15   00:0000                      ;     word START
      16   00:0000                      ;     word 0,0,0,0,0,0
      17   00:0000                      
      18   00:0000                      ;     code
      19   00:0000                      ;------------------------------------------------------------------------
      20   00:0000                      ; END OF HEADER
      21   00:0000                      ;------------------------------------------------------------------------
      22   00:0000                      
      23   00:0000                      ;------------------------------------------------------------------------
      24   00:0000                      ; HEADER FOR GENERATING A BIN FILE - OPEN FROM BASIC
      25   00:0000                      ;------------------------------------------------------------------------
      26   00:0000                          output "../output/msxpong.bin"
      27   00:8200                      
      28   00:8200  FE                      db #fe                  ;cabecera de ficheros que seran cargados con BLOAD desde basic
      29   00:8201  00 82                   dw START
      30   00:8203  18 B8                   dw END
      31   00:8205  00 82                   dw START
      32   00:8207                      
      33   00:8207                          org     #8200           ;starting point of the program in RAM
      34   00:8200                      ;------------------------------------------------------------------------
      35   00:8200                      ; END OF HEADER
      36   00:8200                      ;------------------------------------------------------------------------
      37   00:8200                      
      38   00:8200  (00:009F)           CHGET   equ     #009F
      39   00:8200  (00:00A2)           CHPUT   equ     #00A2
      40   00:8200  (00:00C6)           POSIT   equ     #00C6
      41   00:8200  (00:00B1)           INLIN   equ     #00B1
      42   00:8200  (00:00D8)           GTTRIG  equ     #00D8
      43   00:8200  (00:00D5)           GTSTCK  equ     #00D5
      44   00:8200                      
      45   00:8200  (00:013E)           RDVDP   equ     #013E       ;lee registro status VDP
      46   00:8200  (00:0047)           WRTVDP  equ     #0047       ;escribe registros del VDP
      47   00:8200  (00:005C)           LDIRVM  equ     #005C       ;RAM/ROM -> VRAM
      48   00:8200  (00:0059)           LDIRMV  equ     #0059       ;VRAM -> RAM
      49   00:8200  (00:005F)           CHGMOD  equ     #005F       ;change screen mode
      50   00:8200                      
      51   00:8200  (00:00C0)           BEEP    equ     #00C0       ;generates beep
      52   00:8200  (00:FBE5)           KEYMTX	equ     #FBE5       ;read the keys (Key Matrix, http://map.tni.nl/articles/keymatrix.php)
      53   00:8200                      
      54   00:8200                      
      55   00:8200  (00:F3DF)           RG0SAV  equ     #F3DF       ;Mirror fo VDP register 0 (Basic: VDP(0))
      56   00:8200  (00:F3E0)           RG1SAV  equ     #F3E0       ;Mirror fo VDP register 0 (Basic: VDP(0))
      57   00:8200  (00:F3E1)           RG2SAV  equ     #F3E1       ;Mirror fo VDP register 0 (Basic: VDP(0))
      58   00:8200  (00:F3E2)           RG3SAV  equ     #F3E2       ;Mirror fo VDP register 0 (Basic: VDP(0))
      59   00:8200  (00:F3E3)           RG4SAV  equ     #F3E3       ;Mirror fo VDP register 0 (Basic: VDP(0))
      60   00:8200  (00:F3E4)           RG5SAV  equ     #F3E4       ;Mirror fo VDP register 0 (Basic: VDP(0))
      61   00:8200  (00:F3E5)           RG6SAV  equ     #F3E5       ;Mirror fo VDP register 0 (Basic: VDP(0))
      62   00:8200  (00:F3E6)           RG7SAV  equ     #F3E6       ;Mirror fo VDP register 0 (Basic: VDP(0))
      63   00:8200  (00:F3E7)           STATFL  equ     #F3E7       ;Mirror fo VDP(8) status register (S#0)
      64   00:8200                      
      65   00:8200                      
      66   00:8200                      
      67   00:8200                      START:
      68   00:8200  CD 2F 82                call    initialize_video
      69   00:8203  CD 42 82                call    initialize_tiles_and_sprites
      70   00:8206  CD A3 82                call    initialize_variables
      71   00:8209                          ; call    CHGET
      72   00:8209                      
      73   00:8209                      loop:
      74   00:8209  76                      halt
      75   00:820A  CD C4 83                call    check_collisions
      76   00:820D  CD E1 82                call    update_ball_deltas
      77   00:8210  CD 12 83                call    update_ball_position
      78   00:8213  CD 6C 83                call    update_computer_player
      79   00:8216  CD 91 83                call    update_player_1_controls
      80   00:8219  CD 11 84                call    update_sprite_attrs
      81   00:821C  CD A4 82                call    dump_sprite_attrs_to_ram
      82   00:821F                      
      83   00:821F                      pausemode:
      84   00:821F  3A EC FB                ld	    a,(KEYMTX+7)                        ;escape key is in row 7...
      85   00:8222  CB 57               	bit	    2,a                                 ;...bit 2. If it's pressed...
      86   00:8224  CA 2E 82            	jp	    z,exit                              ;...jump to exit
      87   00:8227                      
      88   00:8227                          ; jr      pausemode
      89   00:8227                      
      90   00:8227  3A 01 B8                ld      a,(goal_status)
      91   00:822A  FE 00                   cp      0
      92   00:822C  28 DB                   jr      z,loop
      93   00:822E                      
      94   00:822E                      exit:
      95   00:822E  C9                      ret
      96   00:822F                      
      97   00:822F                      
      98   00:822F                      initialize_video:
      99   00:822F  3E 02                   ld      a,2                                 ;change to Screen 2
     100   00:8231  CD 5F 00                call    CHGMOD
     101   00:8234                      
     102   00:8234  3A E0 F3                ld      a,(RG1SAV)
     103   00:8237  F6 02                   or      00000010b                           ;force 16x16 sprites (screen 2,2)
     104   00:8239  E6 FE                   and     11111110b                           ;sprites wont be extended
     105   00:823B                      
     106   00:823B  47                      ld      b,a
     107   00:823C  0E 01                   ld      c,1
     108   00:823E  CD 47 00                call    WRTVDP                              ;writes all to the VDP register 1
     109   00:8241  C9                      ret
     110   00:8242                      
     111   00:8242                      
     112   00:8242                      initialize_tiles_and_sprites:
     113   00:8242  21 58 84                ld      hl,tiles_data                       ;load tiles
     114   00:8245  11 00 00                ld      de,#0000
     115   00:8248  01 00 18                ld      bc,256*24
     116   00:824B  CD 5C 00                call    LDIRVM
     117   00:824E                          
     118   00:824E                      
     119   00:824E  21 58 9C                ld      hl,tiles_color                      ;load tile colors
     120   00:8251  11 00 20                ld      de,#2000
     121   00:8254  01 00 18                ld      bc,256*24
     122   00:8257  CD 5C 00                call    LDIRVM
     123   00:825A                      
     124   00:825A                          
     125   00:825A  21 58 B4                ld      hl,screen_data                      ;load screen tile pattern
     126   00:825D  11 00 18                ld      de,#1800
     127   00:8260  01 00 03                ld      bc,256*3
     128   00:8263  CD 5C 00                call    LDIRVM
     129   00:8266                      
     130   00:8266  21 58 B7                ld      hl,spr_ball                       ;load ball sprite
     131   00:8269  11 00 38                ld      de,#3800
     132   00:826C  01 20 00                ld      bc,8*4
     133   00:826F  CD 5C 00                call    LDIRVM
     134   00:8272                      
     135   00:8272  21 78 B7                ld      hl,spr_ply1_1                       ;load player 1 sprite 1
     136   00:8275  11 20 38                ld      de,#3820
     137   00:8278  01 20 00                ld      bc,8*4
     138   00:827B  CD 5C 00                call    LDIRVM
     139   00:827E  21 98 B7                ld      hl,spr_ply1_2                       ;load player 1 sprite 2
     140   00:8281  11 40 38                ld      de,#3840
     141   00:8284  01 20 00                ld      bc,8*4
     142   00:8287  CD 5C 00                call    LDIRVM
     143   00:828A                      
     144   00:828A  21 B8 B7                ld      hl,spr_ply2_1                       ;load player 2 sprite 1
     145   00:828D  11 60 38                ld      de,#3860
     146   00:8290  01 20 00                ld      bc,8*4
     147   00:8293  CD 5C 00                call    LDIRVM
     148   00:8296  21 D8 B7                ld      hl,spr_ply2_2                       ;load player 2 sprite 2
     149   00:8299  11 80 38                ld      de,#3880
     150   00:829C  01 20 00                ld      bc,8*4
     151   00:829F  CD 5C 00                call    LDIRVM
     152   00:82A2                      
     153   00:82A2  C9                      ret
     154   00:82A3                          
     155   00:82A3                      
     156   00:82A3                      initialize_variables:
     157   00:82A3  C9                      ret
     158   00:82A4                      
     159   00:82A4                      dump_sprite_attrs_to_ram:
     160   00:82A4  21 04 B8                ld      hl,ball_spr_attr                    ;set ball sprite attributes
     161   00:82A7  11 00 1B                ld      de,#1b00
     162   00:82AA  01 04 00                ld      bc,4
     163   00:82AD                      
     164   00:82AD  CD 5C 00                call    LDIRVM
     165   00:82B0  21 08 B8                ld      hl,spr_ply1_1_attr                  ;set attributes for player 1 sprite 1
     166   00:82B3  11 04 1B                ld      de,#1b04
     167   00:82B6  01 04 00                ld      bc,4
     168   00:82B9  CD 5C 00                call    LDIRVM
     169   00:82BC  21 0C B8                ld      hl,spr_ply1_2_attr                  ;set attributes for player 1 sprite 2
     170   00:82BF  11 08 1B                ld      de,#1b08
     171   00:82C2  01 04 00                ld      bc,4
     172   00:82C5  CD 5C 00                call    LDIRVM
     173   00:82C8                      
     174   00:82C8  21 10 B8                ld      hl,spr_ply2_1_attr                  ;set attributes for player 2 sprite 1
     175   00:82CB  11 0C 1B                ld      de,#1b0c
     176   00:82CE  01 04 00                ld      bc,4
     177   00:82D1  CD 5C 00                call    LDIRVM
     178   00:82D4  21 14 B8                ld      hl,spr_ply2_2_attr                  ;set attributes for player 2 sprite 2
     179   00:82D7  11 10 1B                ld      de,#1b10
     180   00:82DA  01 04 00                ld      bc,4
     181   00:82DD  CD 5C 00                call    LDIRVM
     182   00:82E0                      
     183   00:82E0  C9                      ret
     184   00:82E1                      
     185   00:82E1                      ;------------------------------------------------------------------------
     186   00:82E1                      ; Update ball increments
     187   00:82E1                      ;------------------------------------------------------------------------
     188   00:82E1                      update_ball_deltas:
     189   00:82E1  3A F9 B7                ld      a,(ball_y)                          ;load ball y position into a registry
     190   00:82E4  FE B2                   cp      178                                 ;compare with 178 (max y is 191)
     191   00:82E6  30 05                   jr      nc,change_ball_delta_y              ;jump if y position greater
     192   00:82E8  FE 06                   cp      6                                   ;compare with 6
     193   00:82EA  38 01                   jr      c,change_ball_delta_y               ;jump if lower
     194   00:82EC                      
     195   00:82EC                      check_delta_x:
     196   00:82EC                          ; ld      a,(ball_x)
     197   00:82EC                          ; cp      247
     198   00:82EC                          ; jp      END
     199   00:82EC                          ; cp      4
     200   00:82EC                          ; jp      END
     201   00:82EC                      delta_ret:
     202   00:82EC  C9                      ret
     203   00:82ED                      
     204   00:82ED                      change_ball_delta_y:
     205   00:82ED                          ; ld      a,(ball_bounces)
     206   00:82ED                          ; inc     a
     207   00:82ED                          ; ld      (ball_bounces),a
     208   00:82ED  3A FB B7                ld      a,(ball_y_inc)                      
     209   00:82F0  FE 01                   cp      1
     210   00:82F2  28 0F                   jr      z,change_ball_delta_y_negative
     211   00:82F4  3A F9 B7                ld      a,(ball_y)                          ;substract a pixel from x
     212   00:82F7  87                      add     a
     213   00:82F8  32 F9 B7                ld      (ball_y),a                          ;end of substract
     214   00:82FB  3E 01                   ld      a,1
     215   00:82FD  32 FB B7                ld      (ball_y_inc),a
     216   00:8300  C3 EC 82                jp      check_delta_x
     217   00:8303                      change_ball_delta_y_negative:
     218   00:8303  3A F9 B7                ld      a,(ball_y)                          ;add a pixel to y
     219   00:8306  3D                      dec     a
     220   00:8307  32 F9 B7                ld      (ball_y),a
     221   00:830A  3E 00                   ld      a,0                                 ;now change delta
     222   00:830C  32 FB B7                ld      (ball_y_inc),a
     223   00:830F  C3 EC 82                jp      check_delta_x
     224   00:8312                      
     225   00:8312                      ; change_ball_delta_x:
     226   00:8312                      ;     ld      a,(ball_bounces)
     227   00:8312                      ;     inc     a
     228   00:8312                      ;     ld      (ball_bounces),a
     229   00:8312                      ;     ld      a,(ball_x_inc)                      
     230   00:8312                      ;     cp      1
     231   00:8312                      ;     jr      z,change_ball_delta_x_negative
     232   00:8312                      ;     ld      a,(ball_x)                          ;substract a pixel from x
     233   00:8312                      ;     add     a
     234   00:8312                      ;     ld      (ball_x),a                          ;end of substract
     235   00:8312                      ;     ld      a,1
     236   00:8312                      ;     ld      (ball_x_inc),a
     237   00:8312                      ;     jp      delta_ret
     238   00:8312                      ; change_ball_delta_x_negative:
     239   00:8312                      ;     ld      a,(ball_x)                          ;add a pixel to x
     240   00:8312                      ;     dec     a
     241   00:8312                      ;     ld      (ball_x),a
     242   00:8312                      ;     ld      a,0                                 ;now change delta
     243   00:8312                      ;     ld      (ball_x_inc),a
     244   00:8312                      ;     jp      delta_ret
     245   00:8312                      
     246   00:8312                      ;------------------------------------------------------------------------
     247   00:8312                      ; Update ball position
     248   00:8312                      ;------------------------------------------------------------------------
     249   00:8312                      update_ball_position:
     250   00:8312  3A FB B7                ld      a,(ball_y_inc)
     251   00:8315  FE 01                   cp      1
     252   00:8317  CA 41 83                jp      z,ball_y_increase
     253   00:831A                      
     254   00:831A  3A FC B7                ld      a,(ball_speed)
     255   00:831D  47                      ld      b,a
     256   00:831E  3A F9 B7                ld      a,(ball_y)
     257   00:8321  CD 68 83                call    loop_position_decrement
     258   00:8324  32 F9 B7                ld      (ball_y),a
     259   00:8327                      
     260   00:8327                      update_pos_x:    
     261   00:8327  3A FA B7                ld      a,(ball_x_inc)
     262   00:832A  FE 01                   cp      1
     263   00:832C  28 22                   jr      z,ball_x_increase
     264   00:832E                          
     265   00:832E  3A FC B7                ld      a,(ball_speed)
     266   00:8331  47                      ld      b,a
     267   00:8332  3A F8 B7                ld      a,(ball_x)
     268   00:8335  CD 68 83                call    loop_position_decrement
     269   00:8338  FE F9                   cp      249 ;ojo
     270   00:833A  D4 50 84                call    nc,goal_player_2
     271   00:833D  32 F8 B7                ld      (ball_x),a
     272   00:8340                      update_ret:
     273   00:8340  C9                      ret
     274   00:8341                      
     275   00:8341                      
     276   00:8341                      ball_y_increase:
     277   00:8341  3A FC B7                ld      a,(ball_speed)
     278   00:8344  47                      ld      b,a
     279   00:8345  3A F9 B7                ld      a,(ball_y)
     280   00:8348  CD 64 83                call    loop_position_increment
     281   00:834B  32 F9 B7                ld      (ball_y),a
     282   00:834E  18 D7                   jr      update_pos_x
     283   00:8350                      
     284   00:8350                      ball_x_increase:
     285   00:8350  3A FC B7                ld      a,(ball_speed)
     286   00:8353  47                      ld      b,a
     287   00:8354  3A F8 B7                ld      a,(ball_x)
     288   00:8357  CD 64 83                call    loop_position_increment
     289   00:835A  FE F9                   cp      249
     290   00:835C  D4 48 84                call    nc,goal_player_1
     291   00:835F  32 F8 B7                ld      (ball_x),a
     292   00:8362  18 DC                   jr      update_ret
     293   00:8364                      
     294   00:8364                      
     295   00:8364                      loop_position_increment
     296   00:8364  3C                      inc     a
     297   00:8365  10 FD                   djnz    loop_position_increment
     298   00:8367  C9                      ret
     299   00:8368                      
     300   00:8368                      loop_position_decrement
     301   00:8368  3D                      dec     a
     302   00:8369  10 FD                   djnz    loop_position_decrement
     303   00:836B  C9                      ret
     304   00:836C                      
     305   00:836C                      
     306   00:836C                      ;------------------------------------------------------------------------
     307   00:836C                      ; Update computer player
     308   00:836C                      ;------------------------------------------------------------------------
     309   00:836C                      update_computer_player:
     310   00:836C  3A FF B7                ld      a,(ply2_y)
     311   00:836F  47                      ld      b,a
     312   00:8370  3A F9 B7                ld      a,(ball_y)
     313   00:8373  B8                      cp      b
     314   00:8374  28 1A                   jr      z,update_computer_player_finish
     315   00:8376  38 0D                   jr      c,update_computer_player_decrease
     316   00:8378  3A 00 B8                ld      a,(computer_speed)
     317   00:837B  47                      ld      b,a
     318   00:837C  3A FF B7                ld      a,(ply2_y)
     319   00:837F  80                      add     a,b
     320   00:8380  32 FF B7                ld      (ply2_y),a
     321   00:8383  18 0B                   jr      update_computer_player_finish
     322   00:8385                      update_computer_player_decrease:
     323   00:8385  3A 00 B8                ld      a,(computer_speed)
     324   00:8388  47                      ld      b,a
     325   00:8389  3A FF B7                ld      a,(ply2_y)
     326   00:838C  90                      sub     a,b
     327   00:838D  32 FF B7                ld      (ply2_y),a
     328   00:8390                      update_computer_player_finish
     329   00:8390  C9                      ret
     330   00:8391                      
     331   00:8391                      ;------------------------------------------------------------------------
     332   00:8391                      ; Update Player from controls
     333   00:8391                      ;------------------------------------------------------------------------
     334   00:8391                      update_player_1_controls
     335   00:8391  AF                      xor     a
     336   00:8392  CD D5 00                call    GTSTCK
     337   00:8395  FE 01                   cp      1
     338   00:8397  28 06                   jr      z,move_player_1_up
     339   00:8399  FE 05                   cp      5
     340   00:839B  28 15                   jr      z,move_player_1_down
     341   00:839D  18 24                   jr      update_player_1_controls_finish
     342   00:839F                      move_player_1_up
     343   00:839F  3A FE B7                ld      a,(ply1_y)
     344   00:83A2  D6 03                   sub     a,3
     345   00:83A4  32 FE B7                ld      (ply1_y),a
     346   00:83A7  FE 10                   cp      16
     347   00:83A9  30 18                   jr      nc,update_player_1_controls_finish
     348   00:83AB  3E 10                   ld      a,16
     349   00:83AD  32 FE B7                ld      (ply1_y),a
     350   00:83B0  18 11                   jr      update_player_1_controls_finish
     351   00:83B2                      move_player_1_down
     352   00:83B2  3A FE B7                ld      a,(ply1_y)
     353   00:83B5  C6 03                   add     a,3
     354   00:83B7  32 FE B7                ld      (ply1_y),a
     355   00:83BA  FE AF                   cp      175
     356   00:83BC  38 05                   jr      c,update_player_1_controls_finish
     357   00:83BE  3E AF                   ld      a,175
     358   00:83C0  32 FE B7                ld      (ply1_y),a
     359   00:83C3                      update_player_1_controls_finish:
     360   00:83C3  C9                      ret
     361   00:83C4                      
     362   00:83C4                      ;------------------------------------------------------------------------
     363   00:83C4                      ; Check collisions
     364   00:83C4                      ;------------------------------------------------------------------------
     365   00:83C4                      check_collisions:
     366   00:83C4  3A E7 F3                ld      a,(STATFL)
     367   00:83C7  CB 6F                   bit     5,a
     368   00:83C9  28 45                   jr      z,check_collisions_end
     369   00:83CB                      
     370   00:83CB  3A FD B7                ld      a,(ball_bounces)                    ;increase ball bounces
     371   00:83CE  3C                      inc     a
     372   00:83CF  32 FD B7                ld      (ball_bounces),a
     373   00:83D2  3A FC B7                ld      a,(ball_speed)                      ;if ball speed is equal a number, continue
     374   00:83D5  FE 04                   cp      4
     375   00:83D7  28 1A                   jr      z,continue_collision
     376   00:83D9  3A FD B7                ld      a,(ball_bounces)                    ;if ball bounces dont reach a number, continue
     377   00:83DC  FE 04                   cp      4
     378   00:83DE  20 13                   jr      nz,continue_collision
     379   00:83E0  3E 00                   ld      a,0                                 ;reset ball bounces to 0
     380   00:83E2  32 FD B7                ld      (ball_bounces),a
     381   00:83E5  3A FC B7                ld      a,(ball_speed)                      ;increase ball speed
     382   00:83E8  3C                      inc     a
     383   00:83E9  32 FC B7                ld      (ball_speed),a
     384   00:83EC  FE 04                   cp      4                                   ;increase computer speed if it lower than 3
     385   00:83EE  30 03                   jr      nc,continue_collision
     386   00:83F0  32 00 B8                ld      (computer_speed),a
     387   00:83F3                      
     388   00:83F3                      continue_collision:
     389   00:83F3  3A FA B7                ld      a,(ball_x_inc)
     390   00:83F6  FE 01                   cp      1
     391   00:83F8  28 0C                   jr      z,ball_collision_set_decrease
     392   00:83FA                      
     393   00:83FA                          ; ld      a,(ball_x)
     394   00:83FA                          ; cp      #F8
     395   00:83FA                          ; jr      nc,check_collisions_end
     396   00:83FA                      
     397   00:83FA  3E 01                   ld      a,1
     398   00:83FC  32 FA B7                ld      (ball_x_inc),a
     399   00:83FF  3E 09                   ld      a,9
     400   00:8401  32 F8 B7                ld      (ball_x),a
     401   00:8404  18 0A                   jr      check_collisions_end
     402   00:8406                      ball_collision_set_decrease:
     403   00:8406  3E 00                   ld      a,0
     404   00:8408  32 FA B7                ld      (ball_x_inc),a
     405   00:840B  3E F0                   ld      a,240
     406   00:840D  32 F8 B7                ld      (ball_x),a
     407   00:8410                      check_collisions_end:
     408   00:8410  C9                      ret
     409   00:8411                      
     410   00:8411                      ;------------------------------------------------------------------------
     411   00:8411                      ; Update sprite attributes
     412   00:8411                      ;------------------------------------------------------------------------
     413   00:8411                      update_sprite_attrs:
     414   00:8411  DD 21 04 B8             ld      ix,ball_spr_attr    ; Update ball attrs
     415   00:8415  3A F9 B7                ld      a,(ball_y)          ; ball Y coordinate
     416   00:8418  DD 77 00                ld      (ix+0),a
     417   00:841B  3A F8 B7                ld      a,(ball_x)          ; ball X coordinate
     418   00:841E  DD 77 01                ld      (ix+1),a
     419   00:8421                      
     420   00:8421  DD 21 0C B8             ld      ix,spr_ply1_2_attr  ; Update player 1 attrs
     421   00:8425  3A FE B7                ld      a,(ply1_y)          ; player 1 Y coordinate
     422   00:8428  DD 77 00                ld      (ix+0),a
     423   00:842B  DD 21 08 B8             ld      ix,spr_ply1_1_attr  ; Update player 1 attrs
     424   00:842F  D6 10                   sub     a,16
     425   00:8431  DD 77 00                ld      (ix+0),a
     426   00:8434                      
     427   00:8434  DD 21 14 B8             ld      ix,spr_ply2_2_attr  ; Update player 2 attrs
     428   00:8438  3A FF B7                ld      a,(ply2_y)          ; player 2 Y coordinate
     429   00:843B  DD 77 00                ld      (ix+0),a
     430   00:843E  DD 21 10 B8             ld      ix,spr_ply2_1_attr  ; Update player 2 attrs
     431   00:8442  D6 10                   sub     a,16
     432   00:8444  DD 77 00                ld      (ix+0),a
     433   00:8447  C9                      ret
     434   00:8448                      
     435   00:8448                      ;------------------------------------------------------------------------
     436   00:8448                      ; Player 1 Goal
     437   00:8448                      ;------------------------------------------------------------------------
     438   00:8448                      goal_player_1:
     439   00:8448  3E 01                   ld      a,1
     440   00:844A  32 01 B8                ld      (goal_status),a
     441   00:844D  3E F9                   ld      a,249
     442   00:844F                          ; call    BEEP
     443   00:844F  C9                      ret
     444   00:8450                      
     445   00:8450                      ;------------------------------------------------------------------------
     446   00:8450                      ; Player 2 Goal
     447   00:8450                      ;------------------------------------------------------------------------
     448   00:8450                      goal_player_2:
     449   00:8450  3E 02                   ld      a,2
     450   00:8452  32 01 B8                ld      (goal_status),a
     451   00:8455  3E 00                   ld      a,0
     452   00:8457                          ; call    BEEP
     453   00:8457  C9                      ret
     454   00:8458                      
     455   00:8458                      ;------------------------------------------------------------------------
     456   00:8458                      ; CONSTANTS
     457   00:8458                      ;------------------------------------------------------------------------
     458   00:8458                      
     459   00:8458                      ;Tiles
     460   00:8458  (1800)              tiles_data:             incbin "bin/pong_tiles.til"
     461   00:9C58  (1800)              tiles_color:            incbin "bin/pong_tiles.col"
     462   00:B458  (0300)              screen_data:            incbin "bin/pong_screen.dat"
     463   00:B758                      
     464   00:B758                      ;Sprites - Ball
     465   00:B758                      ;spr_ball_1:             db  #07,#1F,#33,#6F,#7F,#FF,#FF,#FF,#FF,#FF,#7F,#7F,#3F,#1F,#07,#00,#C0,#F0,#F8,#FC,#FC,#FE,#FE,#FE,#FE,#FE,#FC,#FC,#F8,#F0,#C0,#00
     466   00:B758                      
     467   00:B758                      spr_ball:               db #38,#7C,#FE,#FE,#FE,#7C,#38,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00
     467   00:B758  38 7C FE FE FE 7C 38 00 00 00 00 00 00 00 00 00 
     467   00:B768  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 
     468   00:B778                      
     469   00:B778                      ; Sprites - Player 1
     470   00:B778                      spr_ply1_1:              db #18,#38,#78,#78,#F8,#F8,#F8,#F8,#F8,#F8,#F8,#F8,#F8,#F8,#F8,#F8,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00
     470   00:B778  18 38 78 78 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 
     470   00:B788  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 
     471   00:B798                      spr_ply1_2:              db #F8,#F8,#F8,#F8,#F8,#F8,#F8,#F8,#F8,#F8,#F8,#F8,#78,#78,#38,#18,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00
     471   00:B798  F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 78 78 38 18 
     471   00:B7A8  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 
     472   00:B7B8                      
     473   00:B7B8                      ; Sprites - Player 2
     474   00:B7B8                      spr_ply2_1:              db #C0,#E0,#F0,#F0,#F8,#F8,#F8,#F8,#F8,#F8,#F8,#F8,#F8,#F8,#F8,#F8,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00
     474   00:B7B8  C0 E0 F0 F0 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 
     474   00:B7C8  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 
     475   00:B7D8                      spr_ply2_2:              db #F8,#F8,#F8,#F8,#F8,#F8,#F8,#F8,#F8,#F8,#F8,#F8,#F0,#F0,#E0,#C0,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00,#00
     475   00:B7D8  F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F8 F0 F0 E0 C0 
     475   00:B7E8  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 
     476   00:B7F8                      
     477   00:B7F8                      
     478   00:B7F8                      
     479   00:B7F8                      
     480   00:B7F8                      
     481   00:B7F8                      ;------------------------------------------------------------------------
     482   00:B7F8                      ; VARIABLE DEFINITION
     483   00:B7F8                      ;------------------------------------------------------------------------
     484   00:B7F8  1E                  ball_x:                 db      30
     485   00:B7F9  64                  ball_y:                 db      100
     486   00:B7FA  01                  ball_x_inc:             db      1
     487   00:B7FB  01                  ball_y_inc:             db      1
     488   00:B7FC  01                  ball_speed:             db      1
     489   00:B7FD  00                  ball_bounces:           db      0
     490   00:B7FE  32                  ply1_y:                 db      50
     491   00:B7FF  50                  ply2_y:                 db      80
     492   00:B800  01                  computer_speed:         db      1
     493   00:B801  00                  goal_status:            db      0                   ; 0:no goal, 1:goal player 1, 2:goal player 2
     494   00:B802  00                  player_1_score:         db      0
     495   00:B803  00                  player_2_score:         db      0
     496   00:B804                      
     497   00:B804                      ;ball_spr_attr:          ds      4,0                    ;Y, X, escena, color
     498   00:B804  50 64 00 0F         ball_spr_attr:          db      80, 100, #0, #0F        ;Y, X, escena, color
     499   00:B808                      
     500   00:B808  40 04 04 06         spr_ply1_1_attr:        db      64, 4, 4, 6        ;Y, X, escena, color
     501   00:B80C  50 04 08 06         spr_ply1_2_attr:        db      80, 4, 8, 6        ;Y, X, escena, color
     502   00:B810                      
     503   00:B810  40 F7 0C 07         spr_ply2_1_attr:        db      64, 247, 12, 7        ;Y, X, escena, color
     504   00:B814  50 F7 10 07         spr_ply2_2_attr:        db      80, 247, 16, 7        ;Y, X, escena, color
     505   00:B818                      
     506   00:B818                      END:
     507   00:B818  C9                      ret

    LABELS
-------------------------------------------------
00:0000009F X CHGET
00:000000A2 X CHPUT
00:000000C6 X POSIT
00:000000B1 X INLIN
00:000000D8 X GTTRIG
00:000000D5   GTSTCK
00:0000013E X RDVDP
00:00000047   WRTVDP
00:0000005C   LDIRVM
00:00000059 X LDIRMV
00:0000005F   CHGMOD
00:000000C0 X BEEP
00:0000FBE5   KEYMTX
00:0000F3DF X RG0SAV
00:0000F3E0   RG1SAV
00:0000F3E1 X RG2SAV
00:0000F3E2 X RG3SAV
00:0000F3E3 X RG4SAV
00:0000F3E4 X RG5SAV
00:0000F3E5 X RG6SAV
00:0000F3E6 X RG7SAV
00:0000F3E7   STATFL
00:00008200   START
00:00008209   loop
00:0000821F X pausemode
00:0000822E   exit
00:0000822F   initialize_video
00:00008242   initialize_tiles_and_sprites
00:000082A3   initialize_variables
00:000082A4   dump_sprite_attrs_to_ram
00:000082E1   update_ball_deltas
00:000082EC   check_delta_x
00:000082EC X delta_ret
00:000082ED   change_ball_delta_y
00:00008303   change_ball_delta_y_negative
00:00008312   update_ball_position
00:00008327   update_pos_x
00:00008340   update_ret
00:00008341   ball_y_increase
00:00008350   ball_x_increase
00:00008364   loop_position_increment
00:00008368   loop_position_decrement
00:0000836C   update_computer_player
00:00008385   update_computer_player_decrease
00:00008390   update_computer_player_finish
00:00008391   update_player_1_controls
00:0000839F   move_player_1_up
00:000083B2   move_player_1_down
00:000083C3   update_player_1_controls_finish
00:000083C4   check_collisions
00:000083F3   continue_collision
00:00008406   ball_collision_set_decrease
00:00008410   check_collisions_end
00:00008411   update_sprite_attrs
00:00008448   goal_player_1
00:00008450   goal_player_2
00:00008458   tiles_data
00:00009C58   tiles_color
00:0000B458   screen_data
00:0000B758   spr_ball
00:0000B778   spr_ply1_1
00:0000B798   spr_ply1_2
00:0000B7B8   spr_ply2_1
00:0000B7D8   spr_ply2_2
00:0000B7F8   ball_x
00:0000B7F9   ball_y
00:0000B7FA   ball_x_inc
00:0000B7FB   ball_y_inc
00:0000B7FC   ball_speed
00:0000B7FD   ball_bounces
00:0000B7FE   ply1_y
00:0000B7FF   ply2_y
00:0000B800   computer_speed
00:0000B801   goal_status
00:0000B802 X player_1_score
00:0000B803 X player_2_score
00:0000B804   ball_spr_attr
00:0000B808   spr_ply1_1_attr
00:0000B80C   spr_ply1_2_attr
00:0000B810   spr_ply2_1_attr
00:0000B814   spr_ply2_2_attr
00:0000B818   END


 Output: msx-pong.out
-------------------------------------------------

 Page: 00
  Org: 00008200  Size: *  Used: 00000000

    No output

 Output: ../output/msxpong.bin
-------------------------------------------------

 Page: 00
  Org: 00008200  Size: *  Used: 00003620

   Address   Length Align   Label
   00008200   13856         START
